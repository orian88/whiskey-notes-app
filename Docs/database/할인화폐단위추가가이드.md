# í• ì¸ ê¸ˆì•¡ë³„ í™”í ë‹¨ìœ„ í•„ë“œ ì¶”ê°€ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”
êµ¬ë§¤ ê¸°ë¡ì—ì„œ ê° í• ì¸ ìœ í˜•ë³„ë¡œ ê°œë³„ í™”í ë‹¨ìœ„ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë„ë¡ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.

## ğŸ”§ ì ìš©í•  ë³€ê²½ì‚¬í•­

### 1. ìƒˆë¡œìš´ ì»¬ëŸ¼ ì¶”ê°€
- `basic_discount_currency` - ê¸°ë³¸ í• ì¸ í™”í ë‹¨ìœ„
- `basic_discount_exchange_rate` - ê¸°ë³¸ í• ì¸ í™˜ìœ¨
- `coupon_discount_currency` - ì¿ í° í• ì¸ í™”í ë‹¨ìœ„
- `coupon_discount_exchange_rate` - ì¿ í° í• ì¸ í™˜ìœ¨
- `membership_discount_currency` - ë©¤ë²„ì‹­ í• ì¸ í™”í ë‹¨ìœ„
- `membership_discount_exchange_rate` - ë©¤ë²„ì‹­ í• ì¸ í™˜ìœ¨
- `event_discount_currency` - ì´ë²¤íŠ¸ í• ì¸ í™”í ë‹¨ìœ„
- `event_discount_exchange_rate` - ì´ë²¤íŠ¸ í• ì¸ í™˜ìœ¨

### 2. ì—…ë°ì´íŠ¸ëœ í•¨ìˆ˜
- `calculate_final_price_krw()` - ê° í• ì¸ ìœ í˜•ë³„ ê°œë³„ í™˜ìœ¨ ì ìš©
- `update_final_price_krw()` - íŠ¸ë¦¬ê±° í•¨ìˆ˜ ì—…ë°ì´íŠ¸

## ğŸš€ ì ìš© ë°©ë²•

### 1ë‹¨ê³„: SQL ìŠ¤í‚¤ë§ˆ ì‹¤í–‰
1. Supabase ëŒ€ì‹œë³´ë“œì— ë¡œê·¸ì¸
2. SQL Editorë¡œ ì´ë™
3. `Docs/database/add-discount-currency-fields.sql` íŒŒì¼ ë‚´ìš©ì„ ë³µì‚¬
4. SQL Editorì— ë¶™ì—¬ë„£ê¸°
5. **ì‹¤í–‰** ë²„íŠ¼ í´ë¦­

### 2ë‹¨ê³„: í…Œì´ë¸” êµ¬ì¡° í™•ì¸
```sql
-- purchases í…Œì´ë¸” êµ¬ì¡° í™•ì¸
SELECT column_name, data_type, is_nullable, column_default
FROM information_schema.columns
WHERE table_name = 'purchases'
ORDER BY ordinal_position;
```

### 3ë‹¨ê³„: ìƒ˜í”Œ ë°ì´í„° í…ŒìŠ¤íŠ¸
```sql
-- ìƒˆë¡œìš´ êµ¬ì¡°ë¡œ ìƒ˜í”Œ ë°ì´í„° ì‚½ì… í…ŒìŠ¤íŠ¸
INSERT INTO purchases (
  whiskey_id,
  purchase_date,
  original_price,
  original_currency,
  original_exchange_rate,
  basic_discount_amount,
  basic_discount_currency,
  basic_discount_exchange_rate,
  coupon_discount_amount,
  coupon_discount_currency,
  coupon_discount_exchange_rate,
  membership_discount_amount,
  membership_discount_currency,
  membership_discount_exchange_rate,
  event_discount_amount,
  event_discount_currency,
  event_discount_exchange_rate,
  purchase_location,
  store_name,
  notes
) VALUES (
  (SELECT id FROM whiskeys LIMIT 1),
  '2024-01-15',
  150000,
  'KRW',
  1.0,
  10000,
  'KRW',
  1.0,
  5000,
  'USD',
  1300.0,
  3000,
  'KRW',
  1.0,
  2000,
  'KRW',
  1.0,
  'ì˜¨ë¼ì¸ ì‡¼í•‘ëª°',
  'ë” ì‹ ë¼',
  'í…ŒìŠ¤íŠ¸ êµ¬ë§¤ ê¸°ë¡'
);
```

### 4ë‹¨ê³„: ìµœì¢… ê°€ê²© ê³„ì‚° í™•ì¸
```sql
-- ìµœì¢… ê°€ê²©ì´ ì˜¬ë°”ë¥´ê²Œ ê³„ì‚°ë˜ì—ˆëŠ”ì§€ í™•ì¸
SELECT 
  original_price,
  original_currency,
  basic_discount_amount,
  basic_discount_currency,
  coupon_discount_amount,
  coupon_discount_currency,
  final_price_krw
FROM purchases
ORDER BY created_at DESC
LIMIT 5;
```

## âœ… ì˜ˆìƒ ê²°ê³¼

### ìƒˆë¡œìš´ UI êµ¬ì¡°
```
ì›ë˜ ê°€ê²© - í™”í ë‹¨ìœ„
í• ì¸ ê¸ˆì•¡ --------------------------------------------
ê¸°ë³¸ í• ì¸ ê¸ˆì•¡ - í™”í ë‹¨ìœ„
ì¿ í° í• ì¸ ê¸ˆì•¡ - í™”í ë‹¨ìœ„ (ê¸°ë³¸: KRW)
ë©¤ë²„ì‹­ í• ì¸ ê¸ˆì•¡ - í™”í ë‹¨ìœ„ (ê¸°ë³¸: KRW)
ì´ë²¤íŠ¸ í• ì¸ ê¸ˆì•¡ - í™”í ë‹¨ìœ„ (ê¸°ë³¸: KRW)
```

### ìœ„ìŠ¤í‚¤ ì„ íƒ íŒì—…
- ğŸ” ê²€ìƒ‰ ê¸°ëŠ¥ìœ¼ë¡œ ìœ„ìŠ¤í‚¤ ë¹ ë¥¸ ì°¾ê¸°
- ğŸ–¼ï¸ ì¸ë„¤ì¼ ì´ë¯¸ì§€ë¡œ ì œí’ˆ í™•ì¸
- ğŸ–±ï¸ ë”ë¸”í´ë¦­ ë˜ëŠ” Enterë¡œ ì„ íƒ
- ğŸ“± ë°˜ì‘í˜• ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ

## ğŸ” ë¬¸ì œ í•´ê²°

### ì˜¤ë¥˜ ë°œìƒ ì‹œ
1. **ì»¬ëŸ¼ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²½ìš°**: ìŠ¤í¬ë¦½íŠ¸ê°€ ìë™ìœ¼ë¡œ ê±´ë„ˆëœ€
2. **ê¶Œí•œ ì˜¤ë¥˜**: Supabase í”„ë¡œì íŠ¸ ì†Œìœ ì ê¶Œí•œ í™•ì¸
3. **í•¨ìˆ˜ ì˜¤ë¥˜**: ê¸°ì¡´ í•¨ìˆ˜ë¥¼ ë¨¼ì € ì‚­ì œ í›„ ì¬ìƒì„±

### ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
ê¸°ì¡´ ë°ì´í„°ëŠ” ìë™ìœ¼ë¡œ ê¸°ë³¸ê°’(KRW, í™˜ìœ¨ 1.0)ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.

## ğŸ“Š ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­
- ëª¨ë“  í• ì¸ ê¸ˆì•¡ì„ KRWë¡œ ë³€í™˜í•˜ì—¬ ê³„ì‚°
- íŠ¸ë¦¬ê±°ë¥¼ í†µí•œ ìë™ ìµœì¢… ê°€ê²© ê³„ì‚°
- ì¸ë±ìŠ¤ëŠ” ê¸°ì¡´ êµ¬ì¡° ìœ ì§€

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„
1. SQL ìŠ¤í‚¤ë§ˆ ì ìš© ì™„ë£Œ
2. ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìƒˆë¡œìš´ UI í…ŒìŠ¤íŠ¸
3. ë‹¤ì–‘í•œ í™”í ì¡°í•©ìœ¼ë¡œ êµ¬ë§¤ ê¸°ë¡ í…ŒìŠ¤íŠ¸
4. ì„±ëŠ¥ ë° ì •í™•ì„± ê²€ì¦
